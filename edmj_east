// Variables used by Scriptable.
// These must be at the very top of the file. Do not edit.
// icon-color: blue; icon-glyph: camera-retro;
// Script by Andreas Redeker <hello@andreasredeker.de>

let param = args.widgetParameter
let url

if (param != null && param.length > 0) {
  url = param
} else {
  url = "https://edmj.beck.space/east.jpg"
}

const imgUrl = url
const imgReq = await new Request(imgUrl)
const img = await imgReq.loadImage()

if (config.runsInWidget) {
  let widget = createWidget(img)
  Script.setWidget(widget)
  Script.complete()
} else { 	
  let widget = createWidget(img)
  await widget.presentMedium()
}

function createWidget(img) {

  const widget = new ListWidget()
  widget.backgroundColor = Color.black()
  widget.url = url
  widget.backgroundImage = img 

  widget.addSpacer()

  const titleText = widget.addText('title')
  titleText.font = Font.boldSystemFont(12)
  titleText.textColor = Color.white()
  titleText.shadowRadius = 3
  titleText.shadowColor = Color.black()

  widget.addSpacer(2)

  const subtitleText = widget.addText('subtitle')
  subtitleText.font = Font.systemFont(8)
  subtitleText.textColor = Color.white()
  subtitleText.textOpacity = 0.8
  subtitleText.shadowRadius = 3
  subtitleText.shadowColor = Color.black()

  return widget
}

function getWcNameFromUrl() {
   let wcName = new Request("https://aviationweather.gov/data/metar/?id=EDMA&hours=0");
console.log(await wcName.loadString());
   })
   return wcName
 }
